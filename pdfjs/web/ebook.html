<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Leitor do e-book</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
  margin:0;
  background:#111;
  overflow-x:hidden;
  user-select:none;
}

#pages{
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:20px;
  padding:20px 0;
}

canvas{
  max-width:95%;
  box-shadow:0 0 20px rgba(0,0,0,.6);
}

</style>
</head>

<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
  "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js";

const url = "../../ebook.pdf";
const container = document.getElementById("pages");

pdfjsLib.getDocument(url).promise.then(async pdf => {

  for(let i=1;i<=pdf.numPages;i++){
    const page = await pdf.getPage(i);
    const viewport = page.getViewport({ scale: 1.5 });

    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = viewport.width;
    canvas.height = viewport.height;

    container.appendChild(canvas);

    await page.render({canvasContext:ctx, viewport}).promise;
  }

}).catch(err=>{
  console.error(err);
  alert("Erro ao carregar o ebook.");
});

// Bloqueios básicos
document.addEventListener("contextmenu", e=>e.preventDefault());
document.addEventListener("keydown", e=>{
  if(
    (e.ctrlKey && ["s","p","u"].includes(e.key.toLowerCase())) ||
    e.key === "PrintScreen"
  ){
    e.preventDefault();
    alert("Download, impressão e captura estão desativados.");
  }
});
document.addEventListener("dragstart", e=>e.preventDefault());
</script>

</body>
</html>
